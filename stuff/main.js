var doc;$(function(){$("body>h2").hide();$(".tabs,.panes").show();$(".tabs").tabs(".panes>.pane",{history:true});doc={button:$("input[type=button]"),input:$("input[type=text]"),gif:$("#loading"),result:$("#result"),start_url:$("#start_url>a"),end_url:$("#end_url>a"),redirects:$("#redirects"),redirects_text:$("#redirects>h3"),list:$("#redirects>ol"),initial:$("#initialtext"),error:$("#error")};doc.button.click(function(){try{doc.button.attr("disabled",true);doc.initial.fadeOut("fast",function(){doc.result.fadeOut("fast",function(){doc.error.fadeOut("fast",
function(){doc.redirects.slideUp("fast",function(){doc.gif.fadeIn("fast",function(){try{$.post("/expand",{url:doc.input.val()},function(a){doc.gif.fadeOut("fast",function(){try{if(a){if(a.redirects>0){redirects=a.redirects;doc.start_url.attr("href",a.start_url).text(a.start_url);doc.end_url.attr("href",a.end_url).text(a.end_url);doc.result.fadeIn("fast");show_redirects(a.urls,"All redirects:")}else if(a.status=="TooManyRedirects"){error("Too many redirects!",a);show_redirects(a.urls,"This is how far we got:")}else a.status==
"InvalidURL"?error("Invalid URL!",a):error("URL doesn't redirect anywhere!",a);doc.button.attr("disabled",false)}else error("Internal error")}catch(c){error("Internal error")}})},"json")}catch(d){error("Internal error")}})})})})})}catch(b){error("Internal error")}});$("html").ajaxError(function(){doc.gif.fadeOut("fast",function(){error("Internal error")})});$(document).ready(function(){doc.input.select().focus()});doc.input.keydown(function(b){if(b.keyCode==13){$("input[type=button]").click();return false}})});
function error(b){doc.error.text(b).fadeIn("slow")}function show_redirects(b,d){doc.redirects_text.text(d);doc.list.empty();$.each(b,function(a,c){doc.list.append("<li><a></a></li>").children().last().children().text(c).attr("href",c)});doc.redirects.slideDown("slow")};